    - name: Build APK
      working-directory: ./android
      run: |
        export ANDROID_SDK_ROOT=$HOME/.buildozer/android/platform/android-sdk
        # 使用重试机制，确保最终失败时退出码非0
        for i in 1 2 3; do
          echo "Attempt $i..."
          if buildozer -v android debug; then
            echo "Build succeeded!"
            exit 0
          fi
          echo "Attempt $i failed"
          sleep 30
        done
        echo "All attempts failed"
        exit 1  # 关键：确保失败时退出
      env:
        BUILDOZER_WARN_ON_ROOT: '0'
        ANDROID_SDK_ROOT: /home/runner/.buildozer/android/platform/android-sdk
